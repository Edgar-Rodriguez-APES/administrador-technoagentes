"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{283:(e,r,t)=>{t.d(r,{A:()=>g,O:()=>u});var n=t(5155),a=t(2115),s=t(2248),i=t(9995),o=t(7016),l=t(2082),c=t(4462),d=t(9829),h=t(194),m=t(5695);let x=(0,a.createContext)(void 0),u=e=>{let{children:r}=e,[t,u]=(0,a.useState)(null),[g,p]=(0,a.useState)(!1),[f,y]=(0,a.useState)(!0),v=(0,m.useRouter)();(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{y(!0);let e=await (0,s.H)(),r=await (0,i.T)();u({username:e.username,email:r.email||"",tenantId:r["custom:tenantId"]||"",role:r["custom:role"]||"user",attributes:r}),p(!0)}catch(e){u(null),p(!1)}finally{y(!1)}},w=async(e,r)=>{try{y(!0),await (0,o.J)({username:e,password:r});let t=await (0,i.T)();u({username:e,email:t.email||"",tenantId:t["custom:tenantId"]||"",role:t["custom:role"]||"user",attributes:t}),p(!0),v.push("/dashboard")}catch(e){throw console.error("Error signing in:",e),e}finally{y(!1)}},N=async()=>{try{y(!0),await (0,l.C)(),u(null),p(!1),v.push("/login")}catch(e){throw console.error("Error signing out:",e),e}finally{y(!1)}},j=async(e,r,t)=>{try{y(!0),await (0,c.H)({username:e,password:r,options:{userAttributes:{email:e,"custom:tenantId":t}}})}catch(e){throw console.error("Error signing up:",e),e}finally{y(!1)}},R=async(e,r)=>{try{y(!0),await (0,d.z)({username:e,confirmationCode:r})}catch(e){throw console.error("Error confirming sign up:",e),e}finally{y(!1)}},k=async e=>{try{y(!0),await (0,h.x)({username:e})}catch(e){throw console.error("Error requesting password reset:",e),e}finally{y(!1)}},E=async(e,r,t)=>{try{y(!0),await (0,h.x)({username:e,confirmationCode:r,newPassword:t})}catch(e){throw console.error("Error resetting password:",e),e}finally{y(!1)}};return(0,n.jsx)(x.Provider,{value:{user:t,isAuthenticated:g,isLoading:f,signIn:w,signOut:N,signUp:j,confirmSignUp:R,forgotPassword:k,resetPassword:E},children:r})},g=()=>{let e=(0,a.useContext)(x);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},544:(e,r,t)=>{t.d(r,{A:()=>m});var n=t(5155),a=t(2115),s=t(6874),i=t.n(s),o=t(283),l=t(7737);let c=()=>{let{user:e,signOut:r,isAuthenticated:t}=(0,o.A)(),{tenant:s}=(0,l.K)(),[c,d]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1);return(0,n.jsxs)("header",{className:"bg-white shadow",children:[(0,n.jsx)("div",{className:"px-4 mx-auto max-w-7xl sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex justify-between h-16",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex items-center flex-shrink-0",children:(0,n.jsx)(i(),{href:"/",className:"text-xl font-bold text-indigo-600",children:"Administrador Technoagentes"})}),t&&(0,n.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,n.jsx)(i(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-900 border-b-2 border-indigo-500",children:"Dashboard"}),(null==e?void 0:e.role)==="admin"&&(0,n.jsx)(i(),{href:"/tenants",className:"inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700",children:"Inquilinos"}),(0,n.jsx)(i(),{href:"/users",className:"inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700",children:"Usuarios"}),(0,n.jsx)(i(),{href:"/settings",className:"inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700",children:"Configuraci\xf3n"})]})]}),(0,n.jsx)("div",{className:"hidden sm:ml-6 sm:flex sm:items-center",children:t?(0,n.jsxs)("div",{className:"relative ml-3",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("button",{type:"button",className:"flex text-sm bg-white rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500",id:"user-menu","aria-expanded":"false","aria-haspopup":"true",onClick:()=>{d(!c)},children:[(0,n.jsx)("span",{className:"sr-only",children:"Abrir men\xfa de usuario"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-8 h-8 text-white bg-indigo-600 rounded-full",children:null==e?void 0:e.email.charAt(0).toUpperCase()}),(0,n.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:null==e?void 0:e.email})]})]})}),c&&(0,n.jsxs)("div",{className:"absolute right-0 z-10 w-48 py-1 mt-2 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu",children:[(0,n.jsxs)("div",{className:"px-4 py-2 text-xs text-gray-500",children:[(null==s?void 0:s.name)||"Mi Empresa",(0,n.jsxs)("div",{className:"mt-1 text-xs font-medium text-indigo-600",children:[(null==s?void 0:s.plan)==="BASIC"&&"Plan B\xe1sico",(null==s?void 0:s.plan)==="STANDARD"&&"Plan Est\xe1ndar",(null==s?void 0:s.plan)==="PREMIUM"&&"Plan Premium"]})]}),(0,n.jsx)(i(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Mi Perfil"}),(0,n.jsx)(i(),{href:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Configuraci\xf3n"}),(0,n.jsx)("button",{onClick:r,className:"block w-full px-4 py-2 text-sm text-left text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Cerrar Sesi\xf3n"})]})]}):(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)(i(),{href:"/login",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-indigo-600 bg-white border border-indigo-600 rounded-md hover:bg-indigo-50",children:"Iniciar Sesi\xf3n"}),(0,n.jsx)(i(),{href:"/register",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700",children:"Registrarse"})]})}),(0,n.jsx)("div",{className:"flex items-center -mr-2 sm:hidden",children:(0,n.jsxs)("button",{type:"button",className:"inline-flex items-center justify-center p-2 text-gray-400 rounded-md hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500","aria-expanded":"false",onClick:()=>{m(!h)},children:[(0,n.jsx)("span",{className:"sr-only",children:"Abrir men\xfa principal"}),(0,n.jsx)("svg",{className:"block w-6 h-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})})]})}),h&&(0,n.jsxs)("div",{className:"sm:hidden",children:[t?(0,n.jsxs)("div",{className:"pt-2 pb-3 space-y-1",children:[(0,n.jsx)(i(),{href:"/dashboard",className:"block py-2 pl-3 pr-4 text-base font-medium text-indigo-700 border-l-4 border-indigo-500 bg-indigo-50",children:"Dashboard"}),(null==e?void 0:e.role)==="admin"&&(0,n.jsx)(i(),{href:"/tenants",className:"block py-2 pl-3 pr-4 text-base font-medium text-gray-600 border-l-4 border-transparent hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800",children:"Inquilinos"}),(0,n.jsx)(i(),{href:"/users",className:"block py-2 pl-3 pr-4 text-base font-medium text-gray-600 border-l-4 border-transparent hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800",children:"Usuarios"}),(0,n.jsx)(i(),{href:"/settings",className:"block py-2 pl-3 pr-4 text-base font-medium text-gray-600 border-l-4 border-transparent hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800",children:"Configuraci\xf3n"})]}):(0,n.jsxs)("div",{className:"pt-2 pb-3 space-y-1",children:[(0,n.jsx)(i(),{href:"/login",className:"block py-2 pl-3 pr-4 text-base font-medium text-indigo-700 border-l-4 border-indigo-500 bg-indigo-50",children:"Iniciar Sesi\xf3n"}),(0,n.jsx)(i(),{href:"/register",className:"block py-2 pl-3 pr-4 text-base font-medium text-gray-600 border-l-4 border-transparent hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800",children:"Registrarse"})]}),t&&(0,n.jsxs)("div",{className:"pt-4 pb-3 border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center px-4",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 text-white bg-indigo-600 rounded-full",children:null==e?void 0:e.email.charAt(0).toUpperCase()})}),(0,n.jsxs)("div",{className:"ml-3",children:[(0,n.jsx)("div",{className:"text-base font-medium text-gray-800",children:null==e?void 0:e.email}),(0,n.jsx)("div",{className:"text-sm font-medium text-gray-500",children:(null==s?void 0:s.name)||"Mi Empresa"})]})]}),(0,n.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,n.jsx)(i(),{href:"/profile",className:"block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100",children:"Mi Perfil"}),(0,n.jsx)(i(),{href:"/settings",className:"block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100",children:"Configuraci\xf3n"}),(0,n.jsx)("button",{onClick:r,className:"block w-full px-4 py-2 text-base font-medium text-left text-gray-500 hover:text-gray-800 hover:bg-gray-100",children:"Cerrar Sesi\xf3n"})]})]})]})]})};var d=t(5695);let h=()=>{let e=(0,d.usePathname)(),{user:r}=(0,o.A)(),t=(null==r?void 0:r.role)==="admin",a=[{name:"Dashboard",href:"/dashboard",icon:(0,n.jsx)("svg",{className:"w-6 h-6 mr-3 text-gray-400 group-hover:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"Inquilinos",href:"/tenants",icon:(0,n.jsx)("svg",{className:"w-6 h-6 mr-3 text-gray-400 group-hover:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),adminOnly:!0},{name:"Usuarios",href:"/users",icon:(0,n.jsx)("svg",{className:"w-6 h-6 mr-3 text-gray-400 group-hover:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{name:"Agentes",href:"/agents",icon:(0,n.jsx)("svg",{className:"w-6 h-6 mr-3 text-gray-400 group-hover:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})},{name:"Configuraci\xf3n",href:"/settings",icon:(0,n.jsxs)("svg",{className:"w-6 h-6 mr-3 text-gray-400 group-hover:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}];return(0,n.jsx)("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:(0,n.jsxs)("div",{className:"flex flex-col flex-grow pt-5 overflow-y-auto bg-indigo-700",children:[(0,n.jsx)("div",{className:"flex items-center flex-shrink-0 px-4",children:(0,n.jsx)("span",{className:"text-xl font-bold text-white",children:"Administrador Technoagentes"})}),(0,n.jsx)("div",{className:"flex flex-col flex-grow mt-5",children:(0,n.jsx)("nav",{className:"flex-1 px-2 pb-4 space-y-1",children:a.filter(e=>!e.adminOnly||t).map(r=>{let t=e===r.href;return(0,n.jsxs)(i(),{href:r.href,className:"group flex items-center px-2 py-2 text-sm font-medium rounded-md ".concat(t?"bg-indigo-800 text-white":"text-indigo-100 hover:bg-indigo-600 hover:text-white"),children:[r.icon,r.name]},r.name)})})})]})})},m=e=>{let{children:r}=e,{isAuthenticated:t}=(0,o.A)();return(0,n.jsx)("div",{className:"min-h-screen bg-gray-100",children:t?(0,n.jsxs)("div",{children:[(0,n.jsx)(h,{}),(0,n.jsxs)("div",{className:"flex flex-col md:pl-64",children:[(0,n.jsx)(c,{}),(0,n.jsx)("main",{className:"flex-1",children:(0,n.jsx)("div",{className:"py-6",children:(0,n.jsx)("div",{className:"px-4 mx-auto max-w-7xl sm:px-6 md:px-8",children:r})})})]})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)(c,{}),(0,n.jsx)("main",{children:(0,n.jsx)("div",{className:"px-4 py-6 mx-auto max-w-7xl sm:px-6 lg:px-8",children:r})})]})})}},722:(e,r,t)=>{t.d(r,{DL:()=>l,IN:()=>d,r6:()=>s,we:()=>c});let n=(0,t(7126).D)(),a="TechnoagentesAPI";var s=function(e){return e.UNAUTHORIZED="UNAUTHORIZED",e.FORBIDDEN="FORBIDDEN",e.NOT_FOUND="NOT_FOUND",e.VALIDATION_ERROR="VALIDATION_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.NETWORK_ERROR="NETWORK_ERROR",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e}({});class i extends Error{constructor(e,r,t,n){super(e),this.name="ApiError",this.type=r,this.statusCode=t,this.details=n}}let o=e=>{var r,t;if(console.error("API Error:",e),!e.response)return new i("Error de conexi\xf3n. Por favor, verifica tu conexi\xf3n a internet.","NETWORK_ERROR");let n=null==(r=e.response)?void 0:r.status,a=null==(t=e.response)?void 0:t.data;switch(n){case 401:return new i("No autorizado. Por favor, inicia sesi\xf3n nuevamente.","UNAUTHORIZED",n,a);case 403:return new i("No tienes permisos para realizar esta acci\xf3n.","FORBIDDEN",n,a);case 404:return new i("Recurso no encontrado.","NOT_FOUND",n,a);case 400:case 422:return new i("Error de validaci\xf3n. Por favor, verifica los datos ingresados.","VALIDATION_ERROR",n,a);case 500:case 502:case 503:case 504:return new i("Error del servidor. Por favor, intenta m\xe1s tarde.","SERVER_ERROR",n,a);default:return new i("Error desconocido. Por favor, intenta m\xe1s tarde.","UNKNOWN_ERROR",n,a)}},l={getUsers:async()=>{try{return(await n.get(a,"/tenants/users",{})).users||[]}catch(e){throw o(e)}},getUser:async e=>{try{return await n.get(a,"/tenants/users/".concat(e),{})}catch(e){throw o(e)}},createUser:async e=>{try{return await n.post(a,"/tenants/users",{body:e})}catch(e){throw o(e)}},updateUser:async(e,r)=>{try{return await n.put(a,"/tenants/users/".concat(e),{body:r})}catch(e){throw o(e)}},deleteUser:async e=>{try{await n.del(a,"/tenants/users/".concat(e),{})}catch(e){throw o(e)}}},c={getConfig:async e=>{try{return await n.get(a,"/tenants/configurations/".concat(e),{})}catch(e){throw o(e)}},updateConfig:async(e,r)=>{try{return await n.put(a,"/tenants/configurations/".concat(e),{body:r})}catch(e){throw o(e)}}},d={getCurrentTenant:async()=>{try{return await n.get(a,"/tenants/current",{})}catch(e){throw o(e)}},getTenant:async e=>{try{return await n.get(a,"/tenants/".concat(e),{})}catch(e){throw o(e)}},updateTenant:async(e,r)=>{try{return await n.put(a,"/tenants/".concat(e),{body:r})}catch(e){throw o(e)}},createTenant:async e=>{try{return await n.post(a,"/tenants",{body:e})}catch(e){throw o(e)}}}},7737:(e,r,t)=>{t.d(r,{K:()=>c,W:()=>l});var n=t(5155),a=t(2115),s=t(283),i=t(722);let o=(0,a.createContext)(void 0),l=e=>{let{children:r}=e,[t,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[h,m]=(0,a.useState)(null),{user:x,isAuthenticated:u}=(0,s.A)();(0,a.useEffect)(()=>{u&&x&&g()},[u,x]);let g=async()=>{if(null==x?void 0:x.tenantId)try{d(!0),m(null);let e=await i.IN.getCurrentTenant(),r=await i.we.getConfig("general");l({...e,tenantId:e.id,configuration:r.settings})}catch(e){console.error("Error fetching tenant data:",e),m(e)}finally{d(!1)}},p=async(e,r)=>{if(null==x?void 0:x.tenantId)try{d(!0),m(null),await i.we.updateConfig(e,{settings:r}),t&&l({...t,configuration:{...t.configuration,[e]:r}})}catch(r){throw console.error("Error updating tenant ".concat(e," configuration:"),r),m(r),r}finally{d(!1)}};return(0,n.jsx)(o.Provider,{value:{tenant:t,isLoading:c,error:h,fetchTenant:g,updateTenantConfig:p},children:r})},c=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTenant must be used within a TenantProvider");return e}}}]);